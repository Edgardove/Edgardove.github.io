<!DOCTYPE html>
<html lang="en"><head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155264062-1"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155264062-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Clustering: Mean Shift | Machine Learning with numerical examples</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Clustering: Mean Shift" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Mean Shift is an iterative technique used for clustering a dataset. And it does by locating “high density areas” into the dataset. The algorithm search and locate the zones with more density points." />
<meta property="og:description" content="Mean Shift is an iterative technique used for clustering a dataset. And it does by locating “high density areas” into the dataset. The algorithm search and locate the zones with more density points." />
<link rel="canonical" href="http://localhost:4000/machine-learning-algorithms/2020/01/08/clustering-mean-shift.html" />
<meta property="og:url" content="http://localhost:4000/machine-learning-algorithms/2020/01/08/clustering-mean-shift.html" />
<meta property="og:site_name" content="Machine Learning with numerical examples" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-01-08T00:00:00-04:00" />
<script type="application/ld+json">
{"headline":"Clustering: Mean Shift","dateModified":"2020-01-08T00:00:00-04:00","datePublished":"2020-01-08T00:00:00-04:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/machine-learning-algorithms/2020/01/08/clustering-mean-shift.html"},"url":"http://localhost:4000/machine-learning-algorithms/2020/01/08/clustering-mean-shift.html","description":"Mean Shift is an iterative technique used for clustering a dataset. And it does by locating “high density areas” into the dataset. The algorithm search and locate the zones with more density points.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/assets/post.css">
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        messageStyle: 'none',
        tex2jax: {preview: 'none'},
        CommonHTML: {
          scale: 97
        }
      });

      MathJax.Hub.Register.StartupHook("End", function () {
        document.getElementsByClassName('mask_load')[0].style.display='none';
      });
    </script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>
    <script src="/assets/jquery_3.3.1.min.js"></script>
    <script src="/assets/post.js"></script><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Machine Learning with numerical examples" /></head>
  <body>
	<div class="container">
	<main>
		<section class="menu_slide menu_invisible" itemscope itemtype="http://schema.org/ItemList">
		
		</section>

		<section class="slides_content">
		<header class="post-header">
			<h1 class="post-title p-name" itemprop="name headline">Clustering: Mean Shift</h1>
			<p class="post-meta">
				<time class="dt-published" datetime="2020-01-08T00:00:00-04:00" itemprop="datePublished">Jan 8, 2020
				</time></p>

			<i class="fa fa-bars" id="menu"></i>

			<a href="/" title="Home">
				<i class="fa fa-home"></i>
			</a>
			<a href="/about" title="About">
				<i class="fa fa-question-circle"></i>
			</a>
			<a href="/privacy-policies" title="Read privacy policies">
				<i class="fa fa-user-secret"></i>
			</a>
		</header>

		<section class="slides" itemscope itemtype="http://schema.org/PresentationDigitalDocument" itemprop="articleBody">
			<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Overview</h1>

        <p class="article">
            <em>Mean Shift</em> is an iterative technique used for clustering a dataset. And it does by
            locating "high density areas" into the dataset. A graphical example would be this:
        </p>

        <img src="/assets/images/posts/0.png" alt="MEAN SHIFT DATASET" class="image">

        <p class="article">
            The algorithm search and locate the zones with more density points
        </p>

        <img src="/assets/images/posts/clustering_marks.png" alt="CLUSTERING MARKS" class="image">
    
        <p class="article">
            And group the data:
        </p>

        <img src="/assets/images/posts/clustering.gif" alt="CLUSTERING ANIMATION">
    </article>
</section>

<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Algorithm</h1>

        <ul>
            <li>Let \(\boldsymbol{X}\) be the dataset</li>
            <li>\(\boldsymbol{S}\gets\boldsymbol{X}\)</li>
            <li>
                Let \(K(\boldsymbol{x})\) be a unit flat kernel:

                <p class="latex">
                    \[
                    K(\boldsymbol{x})=
                    \begin{cases}
                    1   & \quad \text{if } \|\boldsymbol{x}\| \le 1 \\
                    0   & \quad \text{if } \|\boldsymbol{x}\| > 1
                    \end{cases}
                    \]
                </p>
            </li>
            <li>Let \(h>0\) be the bandwidth: a free parameter</li>
        </ul>

        <h2>Iteration</h2>

        <ol>
            <li>
                <p class="latex">\[\boldsymbol{M}=\emptyset\]</p>
            </li>
            <li>
                <p class="latex">
                    \[
                    \boldsymbol{m}(\boldsymbol{x})=\frac{\displaystyle\sum_{\boldsymbol{s} \in \boldsymbol{S}}K \left( \frac{\boldsymbol{s} - \boldsymbol{x}}{h} \right) \boldsymbol{s}}{\displaystyle\sum_{\boldsymbol{s} \in \boldsymbol{S}}K \left( \frac{\boldsymbol{s} - \boldsymbol{x}}{h} \right)},
                    \quad \boldsymbol{M} \gets \boldsymbol{M} \cup \{\boldsymbol{m}(\boldsymbol{x})\},
                    \quad \forall \boldsymbol{x} \in \boldsymbol{X}
                    \]
                </p>
            </li>
            <li>
                <p class="latex">
                \[\text{if  }\exists \boldsymbol{s} \neq \boldsymbol{m}, \quad \forall \boldsymbol{s} \in \boldsymbol{S} \land \forall \boldsymbol{m} \in \boldsymbol{M}:\quad \boldsymbol{S} \gets \boldsymbol{M} \text{, repeat 1 and 2}\]
                </p>
            </li>
        </ol>

        <br>

        <p class="article">
            When the step three holds, \(\boldsymbol{S}\) is the set with the means or centroids of the dataset \(\boldsymbol{X}\).
        </p>
    </article>
</section>

<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Algorithm in python using numpy</h1>

        <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">unit_flat_kernel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_i</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="n">n</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x_i</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">n</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">mean_shift</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bandwidth</span><span class="p">):</span>
    <span class="n">X</span><span class="o">=</span><span class="n">data</span>
    <span class="n">S</span><span class="o">=</span><span class="n">data</span>
    <span class="n">h</span><span class="o">=</span><span class="n">bandwidth</span>
    <span class="n">c</span><span class="o">=</span><span class="mi">0</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">M</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">prev_X</span><span class="o">=</span><span class="n">X</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
            <span class="n">num</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">den</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span>
                <span class="n">num</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unit_flat_kernel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_i</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">x_i</span><span class="p">)</span>
                <span class="n">den</span><span class="o">+=</span><span class="n">unit_flat_kernel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_i</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

            <span class="n">num</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s">'Float64'</span><span class="p">))</span>

            <span class="n">m</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">den</span>

            <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">den</span><span class="p">)</span>


        <span class="n">M</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s">'Float64'</span><span class="p">))</span>

        <span class="n">X</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">prev_X</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'clustered after '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s">' iterations'</span><span class="p">)</span>

            <span class="n">clusters</span><span class="o">=</span><span class="p">[]</span>

            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span> 
                <span class="n">clusters</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">distances</span><span class="o">=</span><span class="p">[]</span>

                <span class="k">for</span> <span class="n">centroid</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
                    <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">point</span><span class="p">))</span>

                <span class="n">idx</span><span class="o">=</span><span class="n">distances</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>

                <span class="n">clusters</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>

            <span class="k">break</span>

        <span class="n">c</span><span class="o">+=</span><span class="mi">1</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">'centroids'</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">'clusters'</span><span class="p">:</span> <span class="n">clusters</span><span class="p">}</span>
        </code></pre></figure>
    </article>
</section>
		</section>

		<section class="buttons_content">
			<button class="btn_action" id="back">
				&lt;
			</button>

			<button class="btn_action" id="next">
				&gt;
			</button>
		</section>
		</section>
	</main>
	</div>
</body>
</html>

