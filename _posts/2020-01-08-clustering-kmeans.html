---
layout: post
title: "Clustering: KMeans"
category: machine-learning-algorithms
description: "K-Menas is about dividing a dataset into k groups, and each data belongs to the group with the nearest mean or center."
tags: [programming languages, math, maths, computers, machine learning, algorithms, machine learning algorithms, neural nets, neural networks, binary numbers, classification, multiclass classification, binary classification, clustering]
---

<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Overview</h1>

        <p class="article">
            <em>K-Means</em> is about dividing a dataset into <em>k</em> groups, and each data
            belongs to the group with the nearest mean or center.
        </p>

        <br>

        <p class="article">
            For example the following data is given, and we set <em>k</em>=5 (five clusters or groups): 
        </p>

        <br>

        <img src="/assets/images/posts/kmeans-non-means.png" alt="DATASET" class="image">

        <br>

        <img src="/assets/images/posts/kmeans-means.png" alt="CLUSTER MARKS" class="image">
        
        <br>

        <img src="/assets/images/posts/kmeans-clustering.gif" alt="CLUSTERING ANIMATION" class="image">
    
        <br>

        <p class="article">
            When the data is divided into <em>k</em> parts, we have clustered the dataset.
        </p>

        <br>

        <img src="/assets/images/posts/kmeans-clustering.png" alt="DATASET CLUSTERING" class="image">
    </article>
</section>

<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Standard algorithm</h1>

        <h2>Random partition</h2>

        <ul>
            <li>Set \(k\): number of clusters</li>
            <li>Let \(\boldsymbol{X}\) be the dataset</li>
            <li>Let \(\boldsymbol{S}_i=\emptyset\text{, for i=1,...,}k\)</li>
            <li>Let \(r\) be a random variable following the discrete uniform distribution over the set \(\{1,...,k\}\)</li>
            <li>\(\boldsymbol{S}_r=\boldsymbol{S}_r\cup\{\boldsymbol{x}\},\quad \forall \boldsymbol{x} \in \boldsymbol{X}\)</li>
        </ul>

        <h2>Assignment and update</h2>

        <ol>
            <li>
                <p class="latex">
                    \[\boldsymbol{m}_i^{(t+1)}=\frac{1}{|\boldsymbol{S}_i^{(t)}|}\displaystyle\sum_{\boldsymbol{x} \in \boldsymbol{S}^{(t)}} \boldsymbol{x}, \text{ for } i=1,...,k\]
                </p>
            </li>
            <li>
                <p class="latex">
                    \[\boldsymbol{S}_i^{(t)}=\{\boldsymbol{x}:\|\boldsymbol{x}-\boldsymbol{m}_i\|^2 \le \|\boldsymbol{x}-\boldsymbol{m}_j\|^2 \quad \forall j, 1 \le j \le k\}\]
                </p>
            </li>
            <li>
                <p class="latex">
                    \[\text{if }\exists \boldsymbol{x} \neq \boldsymbol{z}, \quad \forall \boldsymbol{x} \in \boldsymbol{S}_i^{(t)} \land \forall \boldsymbol{z} \in \boldsymbol{S}_i^{(t+1)}:\quad \text{repeat 1 and 2}\]
                </p>
            </li>
        </ol>

        <br>

        <p class="article">
            When the step three holds, \(\boldsymbol{S}_i\) are the set of clusters and \(\boldsymbol{m}_i\) are the means.
        </p>
    </article>
</section>

<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Algorithm in python using numpy</h1>

        <br>

        {% highlight python %}
def random_partition(data, k):
	clusters=[[] for i in range(k)]
	means=[]

	for i in data:
		clusters[random.randint(0,k-1)].append(i)

	for cluster in clusters:
		means.append(numpy.array(cluster, dtype=numpy.dtype('Float64')).mean(axis=0))

	return numpy.array(means, dtype=numpy.dtype('Float64'))

def kmeans(data, means, k):
	iteration=1

	while True:
		old_centroids=means

		clusters=[[] for i in range(k)]

		for i in range(k):
			for datum in data:
				counter=0

				for mean in means:
					if math.pow(linalg.norm(datum-means[i]),2) <= math.pow(linalg.norm(datum - mean),2):
						counter+=1

					if(counter==k):
						clusters[i].append(datum)

		means=[]

		for cluster in clusters:
			means.append(numpy.array(cluster, dtype=numpy.dtype('Float64')).mean(axis=0))

		means=numpy.array(means, dtype=numpy.dtype('Float64'))

		new_centroids=means

		if(numpy.array_equal(old_centroids, new_centroids)):
			print("non change after " + str(iteration) + " iterations")

			break

		iteration+=1

	return {
		"clusters": clusters,
		"means": means
	}

initial_means=random_partition(data, k)

output=kmeans(data, initial_means, k)
        {% endhighlight %}
    </article>
</section>