---
layout: post
title: "Clustering: Mean Shift"
category: machine-learning-algorithms
description: "Mean Shift is an iterative technique used for clustering a dataset. And it does by locating \"high density areas\" into the dataset. The algorithm search and locate the zones with more density points."
tags: [programming languages, math, maths, computers, machine learning, algorithms, machine learning algorithms, neural nets, neural networks, binary numbers, classification, multiclass classification, binary classification, clustering]
---

<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Overview</h1>

        <p class="article">
            <em>Mean Shift</em> is an iterative technique used for clustering a dataset. And it does by
            locating "high density areas" into the dataset. A graphical example would be this:
        </p>

        <img src="/assets/images/posts/0.png" alt="MEAN SHIFT DATASET" class="image">

        <p class="article">
            The algorithm search and locate the zones with more density points
        </p>

        <img src="/assets/images/posts/clustering_marks.png" alt="CLUSTERING MARKS" class="image">
    
        <p class="article">
            And group the data:
        </p>

        <img src="/assets/images/posts/clustering.gif" alt="CLUSTERING ANIMATION">
    </article>
</section>

<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Algorithm</h1>

        <ul>
            <li>Let \(\boldsymbol{X}\) be the dataset</li>
            <li>\(\boldsymbol{S}\gets\boldsymbol{X}\)</li>
            <li>
                Let \(K(\boldsymbol{x})\) be a unit flat kernel:

                <p class="latex">
                    \[
                    K(\boldsymbol{x})=
                    \begin{cases}
                    1   & \quad \text{if } \|\boldsymbol{x}\| \le 1 \\
                    0   & \quad \text{if } \|\boldsymbol{x}\| > 1
                    \end{cases}
                    \]
                </p>
            </li>
            <li>Let \(h>0\) be the bandwidth: a free parameter</li>
        </ul>

        <h2>Iteration</h2>

        <ol>
            <li>
                <p class="latex">\[\boldsymbol{M}=\emptyset\]</p>
            </li>
            <li>
                <p class="latex">
                    \[
                    \boldsymbol{m}(\boldsymbol{x})=\frac{\displaystyle\sum_{\boldsymbol{s} \in \boldsymbol{S}}K \left( \frac{\boldsymbol{s} - \boldsymbol{x}}{h} \right) \boldsymbol{s}}{\displaystyle\sum_{\boldsymbol{s} \in \boldsymbol{S}}K \left( \frac{\boldsymbol{s} - \boldsymbol{x}}{h} \right)},
                    \quad \boldsymbol{M} \gets \boldsymbol{M} \cup \{\boldsymbol{m}(\boldsymbol{x})\},
                    \quad \forall \boldsymbol{x} \in \boldsymbol{X}
                    \]
                </p>
            </li>
            <li>
                <p class="latex">
                \[\text{if  }\exists \boldsymbol{s} \neq \boldsymbol{m}, \quad \forall \boldsymbol{s} \in \boldsymbol{S} \land \forall \boldsymbol{m} \in \boldsymbol{M}:\quad \boldsymbol{S} \gets \boldsymbol{M} \text{, repeat 1 and 2}\]
                </p>
            </li>
        </ol>

        <br>

        <p class="article">
            When the step three holds, \(\boldsymbol{S}\) is the set with the means or centroids of the dataset \(\boldsymbol{X}\).
        </p>
    </article>
</section>

<section class="slide">
    <article class="content" itemprop="articleBody">
        <h1>Algorithm in python using numpy</h1>

        {% highlight python %}
def unit_flat_kernel(x, x_i, h):
    n=numpy.linalg.norm((x-x_i)/h)

    if n<=1: return 1
    else: return 0

def mean_shift(data, bandwidth):
    X=data
    S=data
    h=bandwidth
    c=0

    while True:
        M=[]
        prev_X=X
        for x in X:
            num=[]
            den=0
            for x_i in S:
                num.append(unit_flat_kernel(x, x_i, h)*x_i)
                den+=unit_flat_kernel(x, x_i, h)

            num=numpy.array(num, dtype=numpy.dtype('Float64'))

            m=numpy.sum(num, axis=0)/den

            M.append(numpy.sum(num, axis=0)/den)


        M=numpy.array(M, dtype=numpy.dtype('Float64'))

        X=numpy.unique(M, axis=0)

        if numpy.array_equal(X, prev_X):
            print('clustered after ' + str(c) + ' iterations')

            clusters=[]

            for t in range(len(X)): 
                clusters.append([])

            for point in data:
                distances=[]

                for centroid in X:
                    distances.append(numpy.linalg.norm(centroid - point))

                idx=distances.index(min(distances))

                clusters[idx].append(point)

            break

        c+=1

    return {'centroids': X, 'clusters': clusters}
        {% endhighlight %}
    </article>
</section>